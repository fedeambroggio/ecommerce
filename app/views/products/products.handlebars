<div class="products__container">
    <input id="cartIdInput" type="hidden" value="{{cartId}}">
    {{#each products}}
      <div class="w-72 bg-white drop-shadow-md rounded-lg">
        <img class="object-cover rounded-tl-lg rounded-tr-lg products__img"
            src={{this.foto}} />
        <div class="px-5 py-3 space-y-2">
            <h3 class="text-lg">{{this.nombre}}</h3>
            <p class="text-md py-0.5">{{this.descripcion}}</p>
            <p class="space-x-2">
                <span class="text-2xl font-semibold">$ {{this.precio}}</span>
                <span class="text-sm text-gray-500">Stock: {{this.stock}}</span>
            </p>
            <div class="flex justify-between items-center pt-3 pb-2">
                <form id="add-to-cart-form" method="post" action="/api/carts/addProduct">
                    <input type="text" name={{this.codigo}} value="1" style="visibility: hidden">
                    <button type="submit" class="px-4 py-2 bg-red-600 hover:bg-amber-600 text-center text-sm text-white rounded duration-300">Agregar al carrito</button>
                </form>
                
            </div>
        </div>
    </div>
    {{/each}}
</div>
{{!-- <script>
  document.onclick = (e) => {
    e.preventDefault()
  }
  document.addEventListener('DOMContentLoaded', function() {
    const addToCartButtons = document.querySelectorAll('.add-to-cart-button');
    const cartIdInput = document.getElementById('cartIdInput');

    addToCartButtons.forEach(button => {
      button.addEventListener('click', e => {
        e.preventDefault();

        const cartId = button.getAttribute('data-cart-id');
        const productId = button.getAttribute('data-product-id');

        fetch(`/api/carts/${cartId}/products`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({productId: productId})
        })
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error('Error al agregar producto al carrito:', error));
      });
    });
  });
</script> --}}